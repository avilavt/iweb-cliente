<!DOCTYPE html>
<html>
<head>
<title>Bikes in MÃ¡laga</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
<script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.9.0.js"></script>
<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-2.2.1.js"></script>
<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
</head>
<body>
    <div class="navbar">
        <div class="navbar-inner">
            <a class="brand" href="{{url_client}}/home/">Home</a>
            <a class="brand" href="{{url_client}}/bicilane/">Bici Lanes</a>
            <a class="brand" href="{{url_client}}/bicipark/">Bici Parkings</a>
            <a class="brand" href="{{url_client}}/profile/"> {{logUser['rol']}} : {{logUser['nombre']}} </a>
        </div>
    </div>

    <div id="main" class="container">
        <div class="span3">
            <h2>Sign Up</h2>
            <form  id="userForm" onSubmit="return false">
                <label for="name">Name</label>
                <input id="name" type="text" name="name" class="span3">
                <label for="email">Email Address</label>
                <input id="email" type="email" name="email" class="span3">
                <label for="role">Role</label>
                <input id="role" type="text" name="role" class="span3">
                <input type="button" id="signupbutton" onclick="signup()" value="Sign up" class="btn btn-primary pull-right">
                <div class="clearfix">
                </div>
            </form>
        </div>
    </div>
    <p id="resultado"></p>
    <p id="resultado2"></p>
    <p id="resultado3"></p>
    <p id="resultado4"></p>
    <p id="resultado5"></p>
    <p id="resultado6"></p>
    <p id="resultado7"></p>
    <p id="resultado8"></p>
    <p id="resultado9"></p>
    <p id="resultado10"></p>
    <p id="resultado11"></p>
    <p id="resultado12"></p>
    <p id="resultado13"></p>


    <script >
      function signup()
      {
        const urlSignUp = "{{url_server}}/IWeb/webresources/entity.usuario/post/";

        var nombre = document.getElementById('name').value;
        var correo = document.getElementById('email').value;
        var rol = document.getElementById('role').value;

        //document.getElementById("name").value = "";
        var datajson = JSON.stringify({"nombre":nombre,"email":correo,"rol":rol});
        document.getElementById("resultado").innerHTML = datajson;

        if(nombre == "" || correo == "" || rol == "")
        {
          document.getElementById("resultado").innerHTML = "Error: data incomplete";
          return;
        }
        document.getElementById("resultado2").innerHTML = datajson + ' -> confirmado que no estan vacios los campos';

        var req = new XMLHttpRequest();
        document.getElementById("resultado3").innerHTML = datajson + " -> " + ' creo request como new XMLHttpRequest';

        req.open("POST",urlSignUp,true);
        document.getElementById("resultado4").innerHTML = datajson + " -> " + ' abro el request como post';

        req.setRequestHeader("Content-type","application/json");
        document.getElementById("resultado5").innerHTML = datajson + " -> " + ' coloco el tipo de contenido en la cabecera';

        req.onreadystatechange = function()
        {

          if (xhr.readyState == 4 && xhr.status == 200)
            {
              document.getElementById("resultado").innerHTML = "User created successfully";
            }
            else
            {
              alert('Error: status code:' + request.status);
            }

        }
        req.send(datajson);
      }
    </script>


</body>
</html>
